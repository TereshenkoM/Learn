Таблица для тестов

```postgresql
create table account (
	account_id bigint generated always as identity primary key,
	balance int check (balance between 0 and 1500000)
);

insert into account (balance) values (1000), (2000);
```

Пример транзакции
```postgresql
begin;

update account set balance = balance-500 where account_id=1;
update account set balance = balance+500 where account_id=2;
  
commit;
```

Теперь попробуем снять 600 рублей с первого аккаунта (это не должно получиться, так как на балансе всего 600 рублей, а увести баланс в минус нельзя).

```postgresql
begin;

update account set balance=balance-600 where account_id=1; -- ERROR!
ERROR: new row for relation "account" violates check constraint "account_balance_check"
ПОДРОБНОСТИ: Failing row contains (1, -100).
```

Попробуем игнорировать
```postgresql
update account set balance=balance+600 where account_id=2;
ERROR: new row for relation "account" violates check constraint "account_balance_check"
ПОДРОБНОСТИ: Failing row contains (1, -100).
```

Попробовав выполнить commit увидим, что не получится и всё равно будет применён rollback.

**Также важно понимать, что в зависимости от нашей логики мы можем применить rollback сами.**

**Примечание** 
Во время транзакции время фиксируется. Если во время транзакции нам всё таки нужно время, то нужно использовать clock_timestamp();