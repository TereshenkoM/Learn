У нас есть такая таблица для каких-то сущностей.
```postgresql
drop table if exists entity;

create table entity (
	entity_id bigint generated always as identity primary key,
	name varchar(50)
);
```

Примечание, primary key - всегда индекс
```
\d entity
Таблица "public.entity"
  Столбец | Тип | Правило сортировки | Допустимость NULL | По умолчанию
-----------+-----------------------+--------------------+-------------------+------------------------------
 entity_id | bigint | | not null | generated always as identity
 name | character varying(50) | | |
Индексы:
    "entity_pkey" PRIMARY KEY, btree (entity_id)
```

Теперь сгененерируем 10 миллионов записей.
```postgresql
insert into entity(name)
select substring(md5(random()::text) || md5(random()::text)
                 from 1 for (floor(random() * 46)::int + 5))
from generate_series(1, 10000000);
```

Проверим сколько весит такая таблица
```postgresql
select pg_size_pretty(pg_relation_size('entity'));
```
Такая таблица весит 653 Мб.

Попробуем выполнить запрос и проверим время выполнения
```postgresql
select entity_id, name from entity where name='aaa';
```

Такой запрос занял порядка 0.400 секунд.


Создадим индекс на этом поле, это займёт какое-то время (здесь idx_entity_name это индекс). По дефолту это b-tree.
```postgresql
create index idx_entity_name on entity(name);
```

При этом мы можем посмотреть размер индекса
```postgresql
select pg_size_pretty(pg_relation_size('idx_entity_name'));
```

Индекс уже весит 475 Мб.

Однако теперь запрос
```postgresql
select entity_id, name from entity where name='aaa';
```

Занимает 0.001 секунду.

Дропнем индекс 
```postgresql
drop index idx_entity_name;
```
И посмотрим explain_analyze

```postgresql
explain (analyze, buffers) select entity_id, name from entity where name='aaa';
____________________
Gather  (cost=1000.00..136624.43 rows=1 width=36) (actual time=152.761..157.781 rows=0 loops=1)
  Workers Planned: 2
  Workers Launched: 2
  Buffers: shared hit=12539 read=71002
  ->  Parallel Seq Scan on entity  (cost=0.00..135624.33 rows=1 width=36) (actual time=143.118..143.118 rows=0 loops=3)
        Filter: ((name)::text = 'jj;jhl'::text)
        Rows Removed by Filter: 3333333
        Buffers: shared hit=12539 read=71002
Planning Time: 0.043 ms
JIT:
  Functions: 6
  Options: Inlining false, Optimization false, Expressions true, Deforming true
  Timing: Generation 0.434 ms, Inlining 0.000 ms, Optimization 0.420 ms, Emission 5.390 ms, Total 6.243 ms
Execution Time: 157.959 ms
```

Теперь снова накатим индекс
```postgresql
create index idx_entity_name on entity(name);
```

И снова посмотрим explain analyze
```postgresql
Index Scan using idx_entity_name on entity  (cost=0.56..8.58 rows=1 width=36) (actual time=0.019..0.019 rows=0 loops=1)
  Index Cond: ((name)::text = 'aaa'::text)
  Buffers: shared read=4
Planning:
  Buffers: shared hit=15 read=1 dirtied=2
Planning Time: 0.111 ms
Execution Time: 0.028 ms
```
Buffers: shared read=4 - показывает сколько страниц мы прочитали, их всего 4!


**Важно**. При удалении таблицы индексы тоже удаляются.

